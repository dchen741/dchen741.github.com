<!doctype html>
<head>
	<meta charset="utf-8">
	<title>Quiz</title>
	<meta name="description" content="My Parse App">
	<meta name="viewport" content="width=device-width">
	<link rel="stylesheet" href="css/reset.css">
	<link rel="stylesheet" href="css/styles.css">
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<script type="text/javascript" src="http://www.parsecdn.com/js/parse-1.2.18.min.js"></script>
</head>

<body>
	<div id="main">
		<h1>Surgeon Quiz</h1>
		<div class="questions">
			<p>Enter your name:</p>
			<form id="form" onsubmit="return false;">
				<input type="text" id="nameInput" />
			</form> 
		</div>
		<div class="questions">
			<p>This quiz has 50 questions.  The format is fill-in-the-blank response.  If you do not know the answer, simply leave it blank and proceed to the next question.  You will not receive any feedback.  There is no time restriction.<p>
			<p> WARNING: Do not click "Enter/Return" while taking the test or else you will have to start over (Bug, sorry!)</p>
			</div>
			<div class="questions">
				<p><b id='categoryText'>test</b></p>
				<p><b id='questionText'>test</b></p>
				<form class="options">
					<input class="option" type="text" name="question" id="answerInput" onsubmit="return false;"><br>
				</form>
			</div>
			<br>
			<input type="button" id='next' value="Next" onclick="nextQuestionClick()">
			<script type="text/javascript">
				Parse.initialize("ASMRRN5iWBqYCX4xmWqE4WVfFexRuVhDuEudAOgh", "ilpKJp7jgCw4L9XBQ6DEUaYVXOxy4iu8QPqEZZ7g");
		var listOfCategories = function(){/*Anatomy
Anatomy
Anatomy
Anatomy
Anatomy
Anatomy
Anatomy
Anatomy
Anatomy
Anatomy
Anatomy
Anatomy
Anatomy
Anatomy
Anatomy
Anatomy
Anatomy
Anatomy
Anatomy
Anatomy
Anatomy
Anatomy
Anatomy
Anatomy
Anatomy
Anatomy
Anatomy
Anatomy
Anatomy
Anatomy
Medical Signs
Medical Signs
Medical Signs
Medical Signs
Medical Signs
Medical Signs
Medical Signs
Medical Signs
Medical Signs
Medical Signs
Medical Signs
Medical Signs
Medical Signs
Medical Signs
Medical Signs
Medical Signs
Medical Signs
Medical Signs
Medical Signs
Medical Signs
*/}.toString().slice(14,-3)
		var listOfQuestions = function(){/*The [thoracic] and [sacral] portions of the vertebral column are considered [kyphotic] curves.
The [cervical] and [lumbar] portions of the vertebral column are considered [lordotic] curves.
The most lateral projection of the [scapula] is the [acromion].
The [coracoid] is the most anterior projection of the [scapula].
The lateral antebrachial cutaneous nerve is a branch off the [musculocutaneous] nerve from the [lateral] cord of the brachial plexus.
The biceps tendon inserts on the [radial] tuberosity.
The brachialis muscle inserts on the [ulnar] tuberosity.
The [anterior] compartment of the brachium is supplied by the [musculocutaneous] nerve.
The [posterior] compartment of the brachium receives innervation from the [radial] nerve.
The [cephalic] vein communicates with the [basilic] vein via the [median cubital] vein.
The [ulnar] nerve runs under the hook of the [hamate] carpal bone.
The [ulnar] nerve enters the hand via the Canal of [Guyton].
The [azygos] vein is the main drainage site for the posterior intercostal veins.
The fibers of the [external] abdominal oblique muscle run in the inferomedial direction.
The fibers of the [internal] abdominal oblique muscle run in the superomedial direction.
The [ilioinguinal] and [genitofemoral] nerves are responsible for the sensory and motor components of the cremaster reflex, respectively.
The [popliteus] muscle unlocks the knee via lateral rotation of the femur.
The [great] saphenous vein travels with the [saphenous] nerve and drains into the [femoral] vein.
The [small] saphenous vein travels with the [sural] nerve and drains into the [popliteal] vein.
The deep peroneal nerve innervating the [anterior] compartment of the lower leg is a branch of the common peroneal nerve.
The muscles in the [lateral] compartment of the lower leg are innervated by the [superficial] peroneal nerve.
The blood supply to the [lateral] compartment of the lower leg is the [peroneal] artery--a branch of the posterior tibial artery.
The [saphenous] nerve, a branch of the femoral nerve, supplies cutaneous innervation to the medial arch of the foot.
The [deep peroneal] nerve supplies cutaneous innervation to the dorsal wedge between toes one and two.
The [tibial] nerve provides cutaneous innervation to the [plantar] side of the heel.
The latissimus dorsi, external abdominal oblique, and the iliac crest form the inferor lumbar triangle of [Petit].
The [Cloquet] node is located in the proximal femoral ring.
The [median] umbilical fold overlays the [urachus], which is the fibrous remnant of the fetal allantois.
The veins in the [falciform] ligament, also known as [Sappey's] plexus, drain into the phrenic veins.
The anastomosis between the mesenteric and the peritoneal veins, formed by the veins of [Retzius], empty into the inferior vena cava.
A positive [Allen's] test indicates the absence of the palmar ulnar-radial anastomosis.
The [Babinski] sign manifests as the [dorsiflexion] of the hallux with subsequent spreading of the remaining phalanges as the lateral plantar surface of the foot is stimulated.
Mastoid ecchymosis following a [basal] skull fracture indicates a positive [Battle's] sign.
[Beck's] triad is the concurrent manifestation of [hypotension], distended neck veins, and distant heart sounds.
[Charcot's] triad characterized by [jaundice], fever, and RUQ pain is indicative of ascending cholangitis.
A positive [Chvostek's] sign, in testing for hypocalcemia, occurs when a tapping over the [facial] nerve elicits abnormal muscle contractions.
A patient presenting with ecchymosis around the [umbilicus] indicative of acute pancreatitis or intraabdominal hemorrhage is said to have a positive [Cullen's] test.
A patient presenting with increased abdominal pain when coughing is diagnosed with [appendicitis] based on a positive [Dunphy] sign.
[Fothergill's] sign diagnoses a rectus sheath hematoma when the patient has an anterior abdominal mass which does not cross the midline and is still palpable beneath tensed abdominal wall muscles.
[Goodsall's] rule differentiates between anterior and posterior anal fistulas.
A patient presenting with a positive [Grey Turner's] sign, or flank ecchymosis, is suffering from a retroperitoneal hemorrhage.
[Hamman's] sign diagnoses a patient with esophageal perforation and pneumomediastinum when the patient presents with crepitus in sync with heartbeat, but not with respiration.
[Homan]'s sign aids in the diagnosis of deep vein thrombosis, when a patient presents with popliteal pain upon [dorsi]flexion of the ankle.
A patient with an [obturator] hernia presenting with pain from the hernia radiating to the knee has a positive [Howship-Romberg] sign.
[Kanavel]'s sign indicates an infection of the flexor digitorum tendon, and is positive with the presentation of slight finger flexion, fusiform swelling, tenderness over the tendon, and pain with passive extension of the digit.
A ring of copper-colored deposit at the corneo-scleral junction indicates a positive [Kayser-Fleischer] ring to diagnose [Wilson]'s disease.
Referred pain to the left shoulder indicates a positive [Kehr's] sign in the diagnosis of a ruptured spleen.
[Kussmaul] breathing describes the labored deep breathing with normal or reduced frequency seen in metabolic acidosis.
Pain at [McBurney]'s point, or the location 2/3 of the way lateral on a line from the umbilicus to the ASIS indicates [appendicitis].
A palpable lymph node in the [umbilicus], or a Sister Mary Joseph nodule, may indicate various abdominal malignancies.
*/}.toString().slice(14,-3)

var splitResult;
var categoryResult;
categoryResult = listOfCategories.split(/\n/);
splitResult = listOfQuestions.split(/\n/);
console.log(splitResult.length);

var QuizInfo = Parse.Object.extend("QuizData");
var quizInfo = new QuizInfo();

var questionNumber;
var currentQuestion;
var questionArray;
var categoryArray;
var categoryText;
var questionText;
var answerText;
var answer;

$(document).ready(function(){
	answers = new Object();
	$('.option').change(function(){
		var answer = ($(this).attr('value'))
		var question = ($(this).attr('name'))
		answers[question] = answer
	})

	var totalQuestions = $('.questions').size();
	currentQuestion = 0;
	questionNumber = 2;
	$questions = $('.questions');
	$questions.hide();
	$($questions.get(currentQuestion)).fadeIn();
	$('#next').click(function(){
		$($questions.get(currentQuestion)).fadeOut(function(){
			if (currentQuestion<2){
				currentQuestion++;
			}
			if (currentQuestion == 1){
				var input = document.getElementById("nameInput").value;
				quizInfo.save({"name": input});
			}
			if (currentQuestion>1){
				questionArray = splitResult;
				questionText = questionArray[questionNumber-2];
				categoryArray = categoryResult;
				categoryText = categoryArray[questionNumber-2];

				var numChoices = 0;
				for (var i = 0, len = questionText.length; i < len; i++) {
					if (questionText[i] == "["){
						numChoices++;
					}
				}
			//alert(numChoices);
			var lBracketCount = 0;
			var rBracketCount = 0;
			var lBracketIndex = 0;
			var rBracketIndex = 0;

			var pickQuestion = Math.floor((Math.random() * numChoices) + 1);
			//alert("question number " + pickQuestion);

			for (var i = 0, len = questionText.length; i < len; i++) {
				if (questionText[i] == "["){
					lBracketCount++;
					if (lBracketCount == pickQuestion){
						lBracketIndex = i;
						//alert("left bracket " + lBracketIndex);
					}
				}	
				if (questionText[i] == "]"){
					rBracketCount++;
					if (rBracketCount == pickQuestion){
						rBracketIndex = i;
						//alert("right bracket " + rBracketIndex);
					}
				}
			}

			answerText = questionText.slice(lBracketIndex+1,rBracketIndex);
			//alert("answer is " + answerText);
			questionText = questionText.slice(0,lBracketIndex) + " __________ " + questionText.slice(rBracketIndex+1,questionText.length);

			for (var i = 0, len = questionText.length; i < len; i++) {
				if ((questionText[i] == "[") || (questionText[i] == "]")){
					questionText = questionText.substr(0,i) + questionText.substr(i+1);
				}
			}
			document.getElementById('categoryText').
				innerHTML = categoryText;
			document.getElementById('questionText').innerHTML = questionText;
			answer = document.getElementById("answerInput").value;
			questionNumber++;
		}
		if(currentQuestion == totalQuestions){
			var result = sum_values()
           //do stuff with the result
           //alert(result);
       }else{
       	$($questions.get(currentQuestion)).fadeIn();
       }
   });
});
});

function nextQuestionClick(){
	if (currentQuestion>1){
		var correctAnswer;

		var answer = document.getElementById("answerInput").value;
		quizInfo.save(null, {
            success: function(quiz){
                quiz.add("answerArray", answer.toLowerCase());
                quizInfo.save();
            }
        });
		if (answer.toLowerCase() == answerText.toLowerCase()){
            quizInfo.save(null, {
                success: function(quiz){
                    quiz.add("questionArray", "t");
                    quiz.save();
                }
            });
		}
		else {
            quizInfo.save(null, {
                success: function(quiz){
                    quiz.add("questionArray", "f");
                    quiz.save();
                }
            });
		};
	}
	document.getElementById("answerInput").value = "";
}
</script>

</body>

</html>
